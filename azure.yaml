name: shadcn-fastapi-starter
metadata:
  template: shadcn-fastapi-starter@0.0.1-beta

infra:
  provider: bicep
  path: infra

services:
  api:
    project: ./backend
    language: python
    host: containerapp
  web:
    project: ./frontend
    language: js
    host: containerapp

hooks:
  postprovision:
    shell: sh
    run: |
      echo "Setting container registry endpoint..."
      azd env set AZURE_CONTAINER_REGISTRY_ENDPOINT $(azd env get-value containerRegistryLoginServer)
      echo "Setting Entra ID client ID..."
      azd env set NEXT_PUBLIC_AZURE_CLIENT_ID $(azd env get-value aadAppClientId)
      echo "Setting Entra ID tenant ID..."
      azd env set NEXT_PUBLIC_AZURE_TENANT_ID $(az account show --query tenantId -o tsv)
    continueOnError: false
